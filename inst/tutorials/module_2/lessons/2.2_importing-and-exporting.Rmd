---
title: "Importing and exporting data"
---
### Importing csv files
Data can come in various forms and from different sources. Two of the most common are csv (comma-separated values) and excel file types.  

The `readr` package is a part of the tidyverse. `readr` provides functions for importing flat files, a two-dimensional tabular structured file where a column represents one dimension and rows represent the other dimension.  

We can use `readr::read_csv()` to import csv flat files:  
```{r, eval=TRUE}
library(readr)
person_data <- read_csv(file = "https://raw.githubusercontent.com/davidcaughlin/R-Tutorial-Data-Files/master/PersData.csv") 

person_data |>
  head()
```

Using `head()` to view the first 6 rows of the imported data, you can see the column names along with the data types (i.e., `id` values are type **double**, `lastname` values are type **character**, etc.).  



### Importing Excel files  
You will often find encounter Excel data. We can use the `readxl` package to import xls and xlsx Excel file types.  
```{r, include=FALSE}
path_excel_data <- system.file("extdata", "PersData_Excel.xlsx", package = "learnrIO", mustWork = TRUE)
```

We can use the `readxl::read_excel()` function which reads xls or xlsx files.  
```{r}
readxl::read_excel(path = path_excel_data)
```

Running the above function with only the 'path' argument returns the first Excel sheet, in this case sheet "Year1". The dataset, however, contains two sheets. The `read_excel()` function provides options for fine-tuning Excel imports, such as importing a sheet other than the first or importing a column/row cell range.  

*Import the second sheet "Year2"*  
```{r}
sheet2 <- readxl::read_excel(
  path = path_excel_data,
  sheet = "Year2"
)
sheet2
```

*Import the first 3 rows from the `id`, `lastname`, and `firstname` columns from the first sheet "Year1"*  
```{r}
sheet1 <- readxl::read_excel(
  path = path_excel_data,
  range = "A1:C4"
)
sheet1
```

Type `?read_xlsx` to see additional examples.  



### Importing other file formats with `haven`  
For other common file formats like SPSS, Stata, and SAS, we can use the haven package.  

**Import SPSS file**  
```{r, include=FALSE}
path_sav_data <- system.file("extdata", "exam.sav", package = "learnrIO", mustWork = TRUE)
```

```{r}
haven::read_sav(path_sav_data) |> head()
```



### Exporting Data
You can easily export a tibble to csv, Excel, or other file formats such as SPSS.  

**Export to csv using `readr`**  
```{r, eval=FALSE}
readr::write_csv(person_data, "person_data.csv")
```

**Export to Excel using `writexl`**  
```{r, eval=FALSE}
writexl::write_xlsx(person_data, "person_data.xlsx")
```

**Export to SPSS using `haven`**  
```{r, eval=FALSE}
haven::write_sav(person_data, "person_data.sav")
```



